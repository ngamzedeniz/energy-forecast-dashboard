<!DOCTYPE html>
<html>
<head>
    <title>Advanced Forecast: {{ ticker }}</title>
    <script src="https://cdn.plot.ly/plotly-latest.min.js"></script> 
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        .weather-card {
            background: linear-gradient(135deg, #e0f0ff, #c3e6ff);
            border-left: 5px solid #007bff;
        }
        .synoptic-box {
            border-top: 1px solid #c3e6ff;
            padding-top: 10px;
        }
        .chart-container {
            border: 1px solid #eee;
            margin-bottom: 20px;
            padding: 10px;
            border-radius: 5px;
        }
    </style>
</head>
<body class="bg-light">
    <div class="container mt-5 p-4 bg-white rounded shadow-lg">
        <h1 class="mb-4 text-primary">üìà Advanced Energy Forecast: {{ ticker }}</h1>
        <hr>

        <div class="row mb-5">
            <div class="col-md-6">
                <div class="card border-primary">
                    <div class="card-body">
                        <h5 class="card-title text-primary">üí∞ Next-Day Price</h5>
                        <p class="card-text fs-4"><strong>¬£{{ predicted_price }}</strong></p>
                    </div>
                </div>
            </div>
            <div class="col-md-6">
                <div class="card border-success">
                    <div class="card-body">
                        <h5 class="card-title text-success">üìä Next-Day Volume</h5>
                        <p class="card-text fs-4"><strong>{{ predicted_volume }} Units</strong></p>
                    </div>
                </div>
            </div>
        </div>

        <h2 class="mt-4 mb-3 text-secondary">Meteorological Market Driver Analysis ({{ city }})</h2>
        <div class="row mb-5">
            <div class="col-md-12">
                <div class="card p-3 weather-card h-100">
                    <h5 class="card-title text-info">Trader's Synoptic Insight</h5>
                    <p class="lead">Avg. 24h Wind Speed: <strong>{{ avg_wind_speed }}</strong></p>
                    <p class="lead">Max Wind Gust: <strong>{{ max_wind_text }}</strong></p> 
                    <p class="lead">UK Monthly Norm Temp: <strong>{{ norm_temp }}¬∞C</strong></p> 
                    <div class="synoptic-box">
                        <p class="small text-dark">Meteorological drivers affecting energy markets in {{ city }} over the next 48h.</p>
                        <p class="text-muted small mt-2">Source: Met Office Land Observations</p>
                    </div>
                </div>
            </div>
        </div>

        <h2 class="mt-4 mb-3 text-secondary">Next 48-Hour Meteorological Trends</h2>
        <div class="row">
            <div class="col-md-6">
                <div class="chart-container">
                    {{ temp_plot | safe }}
                </div>
            </div>
            <div class="col-md-6">
                <div class="chart-container">
                    {{ anomaly_plot | safe }}
                </div>
            </div>
            <div class="col-md-12">
                <div class="chart-container">
                    {{ wind_plot | safe }}
                </div>
            </div>
        </div>

        <h3 class="mt-4 mb-3 text-secondary">48-Hour Hourly Data Table</h3>
        <div class="table-responsive mb-5">
            <table class="table table-sm table-hover small">
                <thead class="table-primary">
                    <tr>
                        <th>Time</th>
                        <th>Wind Speed (m/s)</th>
                        <th>Wind Dir (¬∞C)</th>
                        <th>Temp (¬∞C)</th>
                        <th>Anomaly (¬∞C)</th>
                        <th>Precip. (mm)</th>
                        <th>Clouds (%)</th>
                    </tr>
                </thead>
                <tbody>
                    {% for row in detailed_table_data %}
                    <tr>
                        <td>{{ row[0].strftime('%b %d %H:%M') }}</td>
                        <td>{{ row[1] }}</td>
                        <td>{{ row[2] }}</td>
                        <td>{{ row[3] }}</td>
                        <td class="{{ 'text-danger fw-bold' if row[4] > 0 else 'text-primary' }}">{{ row[4] }}</td>
                        <td>{{ row[5] }}</td>
                        <td>{{ row[6] }}</td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
        
        <h2 class="mt-4 mb-3">Financial Performance Charts</h2>
        <div class="card card-body mb-4">
            {{ price_plot | safe }} 
        </div>
        <div class="card card-body mb-4">
            {{ volume_plot | safe }} 
        </div>

        <p class="mt-4"><a href="/" class="btn btn-secondary">‚Üê Run New Forecast</a></p>
    </div>
</body>
</html>
